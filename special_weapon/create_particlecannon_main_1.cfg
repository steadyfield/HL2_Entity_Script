echo "ParticleCannon Script by PulsarField"
echo "Precaching Necessary Models..."

ent_create prop_dynamic model models/props_wasteland/cargo_container01.mdl targetname temp1
ent_fire temp1 kill

ent_create prop_dynamic model models/Airboatgun.mdl targetname temp2
ent_fire temp2 kill

ent_create trigger_multiple targetname controlvol_particlecannon_pulsarfield1 spawnflags 513 model models/props_wasteland/cargo_container01.mdl
ent_fire controlvol_particlecannon_pulsarfield1 addoutput "origin 0 0 10"
ent_fire controlvol_particlecannon_pulsarfield1 addoutput "StartDisabled 0"
ent_fire controlvol_particlecannon_pulsarfield1 addoutput "rendermode 10"
ent_fire controlvol_particlecannon_pulsarfield1 addoutput "spawnflags 513"
ent_fire controlvol_particlecannon_pulsarfield1 addoutput "model models/props_wasteland/cargo_container01.mdl"

ent_create prop_physics_override model models/props_combine/combine_interface001.mdl targetname particlecannon_base_pulsarfield1
ent_fire particlecannon_base_pulsarfield1 addoutput "origin 0 0 0"

ent_fire controlvol_particlecannon_pulsarfield1 setparent particlecannon_base_pulsarfield1

//materials/sprites/laserbeam.vmt materials/sprites/plasmabeam.vmt
ent_create env_laser targetname particlecannon_laser_pulsarfield1 texture materials/effects/blueblacklargebeam.vmt TextureScroll 10 damage 1 dissolvetype 1 spawnflags 0 NoiseAmplitude 0 width 2 EndSprite "sprites/blueflare1.spr"
ent_fire particlecannon_laser_pulsarfield1 addoutput "rendercolor 255 255 255"
ent_fire particlecannon_laser_pulsarfield1 addoutput "renderamt 255"
//ent_fire particlecannon_laser_pulsarfield1 addoutput "renderfx 0"
//ent_fire particlecannon_laser_pulsarfield1 setparent particlecannon_mdl_pulsarfield1

ent_create func_tanklaser targetname particlecannon_pulsarfield1 laserentity particlecannon_laser_pulsarfield1 control_volume controlvol_particlecannon_pulsarfield1 spawnflags 34081 model models/Airboatgun.mdl angles "0 180 0"
ent_fire particlecannon_pulsarfield1 addoutput "origin 0 0 59"
//ent_fire particlecannon_pulsarfield1 addoutput "angles 0 0 0"
ent_fire particlecannon_pulsarfield1 addoutput "renderfx 0"
ent_fire particlecannon_pulsarfield1 addoutput "rendermode 10"
ent_fire particlecannon_pulsarfield1 addoutput "renderamt 255"
ent_fire particlecannon_pulsarfield1 addoutput "rendercolor 255 255 255"
ent_fire particlecannon_pulsarfield1 addoutput "disablereceiveshadows 0"
ent_fire particlecannon_pulsarfield1 addoutput "disableshadows 0"
ent_fire particlecannon_pulsarfield1 addoutput "yawrate 50"
ent_fire particlecannon_pulsarfield1 addoutput "yawrange 70"
ent_fire particlecannon_pulsarfield1 addoutput "yawtolerance 15"
ent_fire particlecannon_pulsarfield1 addoutput "pitchrate 50"
ent_fire particlecannon_pulsarfield1 addoutput "pitchrange 70"
ent_fire particlecannon_pulsarfield1 addoutput "pitchtolerance 15"
ent_fire particlecannon_pulsarfield1 addoutput "barrel 0"
ent_fire particlecannon_pulsarfield1 addoutput "barrely 0"
ent_fire particlecannon_pulsarfield1 addoutput "barrelz 0"
ent_fire particlecannon_pulsarfield1 addoutput "spritescale 1"
ent_fire particlecannon_pulsarfield1 addoutput "firerate 20"
ent_fire particlecannon_pulsarfield1 addoutput "bullet_damage 22"
ent_fire particlecannon_pulsarfield1 addoutput "bullet_damage_vs_player 20"
ent_fire particlecannon_pulsarfield1 addoutput "persistence 3"
ent_fire particlecannon_pulsarfield1 addoutput "persistence2 0"
ent_fire particlecannon_pulsarfield1 addoutput "firespread 0"
ent_fire particlecannon_pulsarfield1 addoutput "minRange 0"
ent_fire particlecannon_pulsarfield1 addoutput "maxRange 2000"
ent_fire particlecannon_pulsarfield1 addoutput "gun_yaw_pose_center 0"
ent_fire particlecannon_pulsarfield1 addoutput "gun_pitch_pose_center 7.5"
ent_fire particlecannon_pulsarfield1 addoutput "ammo_count -1"
ent_fire particlecannon_pulsarfield1 addoutput "LeadTarget No"
ent_fire particlecannon_pulsarfield1 addoutput "playergraceperiod 0"
ent_fire particlecannon_pulsarfield1 addoutput "playerlocktimebeforefire 1.5"
ent_fire particlecannon_pulsarfield1 addoutput "ignoregraceupto 768"
//ent_fire particlecannon_pulsarfield1 addoutput "effecthandling 1"
ent_fire particlecannon_pulsarfield1 addoutput "spawnflags 34081"
ent_fire particlecannon_pulsarfield1 addoutput "control_volume controlvol_particlecannon_pulsarfield1"
ent_fire particlecannon_pulsarfield1 setparent particlecannon_base_pulsarfield1

ent_fire particlecannon_pulsarfield1 addoutput "OnGotController particlecannon_base_pulsarfield1,DisableMotion,,0,-1"
ent_fire particlecannon_pulsarfield1 addoutput "OnGotPlayerController particlecannon_base_pulsarfield1,DisableMotion,,0,-1"
ent_fire particlecannon_pulsarfield1 addoutput "OnLostController particlecannon_base_pulsarfield1,EnableMotion,,0,-1"
ent_fire particlecannon_pulsarfield1 addoutput "OnLostPlayerController particlecannon_base_pulsarfield1,EnableMotion,,0,-1"

ent_fire particlecannon_pulsarfield1 addoutput "OnFire particlecannon_firetrigger_pulsarfield1,Trigger,,0,-1"
ent_fire particlecannon_pulsarfield1 addoutput "OnFire particlecannon_offtimer_pulsarfield1,ResetTimer,,0,-1"

ent_create phys_keepupright targetname particlecannon_base_pulsarfield1_keepupright attach1 particlecannon_base_pulsarfield1 angularlimit 100
ent_fire particlecannon_base_pulsarfield1_keepupright setparent particlecannon_base_pulsarfield1

ent_create info_target targetname particlecannon_start_pulsarfield1 scale 2
ent_fire particlecannon_start_pulsarfield1 addoutput "origin -80 0 59"
ent_fire particlecannon_start_pulsarfield1 setparent particlecannon_mdl_pulsarfield1
//ent_fire particlecannon_start_pulsarfield1 setparentattachment muzzle

//ent_fire particlecannon_laser_pulsarfield1 addoutput "LaserTarget particlecannon_start_pulsarfield1"

//ent_fire particlecannon_pulsarfield1 addoutput "OnFire tank_particlecannon_muzzle_pulsarfield1,Fire,,0,-1"

ent_create info_target targetname particlecannon_npc_standpoint_pulsarfield1
ent_fire particlecannon_npc_standpoint_pulsarfield1 addoutput "origin 35 0 7"
ent_fire particlecannon_npc_standpoint_pulsarfield1 setparent particlecannon_base_pulsarfield1

ent_fire particlecannon_pulsarfield1 addoutput "npc_man_point particlecannon_npc_standpoint_pulsarfield1"

ent_fire env_sprite addoutput "targetname particlecannon_endpos_pulsarfield1"

ent_create logic_relay targetname particlecannon_delay2_pulsarfield1 StartDisabled 0 spawnflags 1
ent_fire particlecannon_delay2_pulsarfield1 addoutput "OnTrigger env_sprite_backup,addoutput,classname env_sprite,0.1,1"
ent_fire particlecannon_delay2_pulsarfield1 addoutput "OnTrigger particlecannon_loader_pulsarfield1,kill,,0.1,1"

ent_create point_hurt targetname particlecannon_hurt_pulsarfield1 DamageRadius 1000 Damage 20 DamageDelay 0.07 DamageType 100663616
ent_fire particlecannon_hurt_pulsarfield1 addoutput "origin 0 0 0"
ent_fire particlecannon_hurt_pulsarfield1 setparent particlecannon_endpos_pulsarfield1

ent_fire particlecannon_delay2_pulsarfield1 Trigger

ent_create logic_relay targetname particlecannon_firetrigger_pulsarfield1 StartDisabled 0 spawnflags 2
ent_fire particlecannon_firetrigger_pulsarfield1 addoutput "OnTrigger particlecannon_offtimer_pulsarfield1,Enable,,0,-1"
ent_fire particlecannon_firetrigger_pulsarfield1 addoutput "OnTrigger particlecannon_offtimer_pulsarfield1,ResetTimer,,0,-1"
ent_fire particlecannon_firetrigger_pulsarfield1 addoutput "OnTrigger particlecannon_hurt_pulsarfield1,TurnOn,,0,-1"
ent_fire particlecannon_firetrigger_pulsarfield1 addoutput "OnTrigger particlecannon_impact_effect_pulsarfield1,Start,,0,-1"
ent_fire particlecannon_firetrigger_pulsarfield1 addoutput "OnTrigger particlecannon_mainbeam_pulsarfield1,TurnOn,,0,-1"
ent_fire particlecannon_firetrigger_pulsarfield1 addoutput "OnTrigger particlecannon_mainbeam2_pulsarfield1,TurnOn,,0,-1"
ent_fire particlecannon_firetrigger_pulsarfield1 addoutput "OnTrigger particlecannon_sound_firestart_pulsarfield1,PlaySound,,0,-1"
ent_fire particlecannon_firetrigger_pulsarfield1 addoutput "OnTrigger particlecannon_sound_fireloop_pulsarfield1,PlaySound,,0,-1"
ent_fire particlecannon_firetrigger_pulsarfield1 addoutput "OnTrigger particlecannon_impact_effect_control_pulsarfield1,Enable,,0,-1"

//ent_fire particlecannon_firetrigger_pulsarfield1 addoutput "OnTrigger particlecannon_effect_pulsarfield1,StartDischarge,,0,-1"
//ent_fire particlecannon_firetrigger_pulsarfield1 addoutput "OnTrigger particlecannon_effect_pulsarfield1,SetTargetEnt,particlecannon_hurt_pulsarfield1,0,-1"
ent_fire particlecannon_firetrigger_pulsarfield1 addoutput "OnTrigger !self,Disable,,0,-1"

ent_create logic_timer targetname particlecannon_offtimer_pulsarfield1 UseRandomTime 0 RefireTime 0.2 StartDisabled 1
ent_fire particlecannon_offtimer_pulsarfield1 addoutput "OnTimer particlecannon_hurt_pulsarfield1,TurnOff,,0,-1"
ent_fire particlecannon_offtimer_pulsarfield1 addoutput "OnTimer !self,Disable,,0,-1"
ent_fire particlecannon_offtimer_pulsarfield1 addoutput "OnTimer particlecannon_firetrigger_pulsarfield1,Enable,,0,-1"
//ent_fire particlecannon_offtimer_pulsarfield1 addoutput "OnTimer particlecannon_effect_pulsarfield1,Stop,0.1,0,-1"
ent_fire particlecannon_offtimer_pulsarfield1 addoutput "OnTimer particlecannon_impact_effect_pulsarfield1,Stop,,0.1,-1"
ent_fire particlecannon_offtimer_pulsarfield1 addoutput "OnTimer particlecannon_impact_effect_control_pulsarfield1,Disable,,0,-1"
ent_fire particlecannon_offtimer_pulsarfield1 addoutput "OnTimer particlecannon_mainbeam_pulsarfield1,TurnOff,,0,-1"
ent_fire particlecannon_offtimer_pulsarfield1 addoutput "OnTimer particlecannon_mainbeam2_pulsarfield1,TurnOff,,0,-1"
ent_fire particlecannon_offtimer_pulsarfield1 addoutput "OnTimer particlecannon_sound_fireloop_pulsarfield1,StopSound,,0,-1"
ent_fire particlecannon_offtimer_pulsarfield1 addoutput "OnTimer particlecannon_sound_firestart_pulsarfield1,StopSound,,0,-1"
ent_fire particlecannon_offtimer_pulsarfield1 addoutput "OnTimer particlecannon_sound_firestop_pulsarfield1,PlaySound,,0,-1"

ent_create logic_timer targetname particlecannon_impact_effect_control_pulsarfield1 UseRandomTime 0 RefireTime 3 StartDisabled 1 spawnflags 1
ent_fire particlecannon_impact_effect_control_pulsarfield1 addoutput "OnTimerHigh particlecannon_impact_effect_pulsarfield1,Start,,0,-1"
ent_fire particlecannon_impact_effect_control_pulsarfield1 addoutput "OnTimerLow particlecannon_impact_effect_pulsarfield1,Stop,,0,-1"
ent_fire particlecannon_impact_effect_control_pulsarfield1 addoutput "OnTimerLow !self,FireTimer,,0.1,-1"

//ent_create env_alyxemp targetname "particlecannon_effect_pulsarfield1" type 1 EndTargetName particlecannon_hurt_pulsarfield1
//ent_fire particlecannon_effect_pulsarfield1 addoutput "origin -80 0 59"
//ent_fire particlecannon_effect_pulsarfield1 addoutput "EndTargetName particlecannon_hurt_pulsarfield1"
//ent_fire particlecannon_effect_pulsarfield1 setparent particlecannon_mdl_pulsarfield1

ent_create info_particle_system targetname particlecannon_impact_effect_pulsarfield1 start_active 0 effect_name portal_rift_01
ent_fire particlecannon_impact_effect_pulsarfield1 addoutput "origin 0 0 10"
ent_fire particlecannon_impact_effect_pulsarfield1 setparent particlecannon_endpos_pulsarfield1

ent_fire particlecannon_mainbeam_pulsarfield1 setparent particlecannon_endpos_pulsarfield1
ent_fire particlecannon_mainbeam_pulsarfield1 addoutput "LaserTarget particlecannon_hurt_pulsarfield1"
ent_fire particlecannon_mainbeam2_pulsarfield1 setparent particlecannon_endpos_pulsarfield1
ent_fire particlecannon_mainbeam2_pulsarfield1 addoutput "LaserTarget particlecannon_mainbeam_pulsarfield1"
//ambient/levels/citadel/zapper_loop1.wav
ent_create ambient_generic targetname particlecannon_sound_fireloop_pulsarfield1 message weapons/egon_run3.wav pitch 100 cspinup 0 pitchstart 100 radius 12000 SourceEntityName particlecannon_impact_effect_pulsarfield1 spawnflags 16 health 5
ent_fire particlecannon_sound_fireloop_pulsarfield1 setparent particlecannon_endpos_pulsarfield1

ent_create ambient_generic targetname particlecannon_sound_firestart_pulsarfield1 message weapons/egon_windup2.wav pitch 100 cspinup 0 pitchstart 100 radius 12000 SourceEntityName particlecannon_impact_effect_pulsarfield1 spawnflags 16 health 10
ent_fire particlecannon_sound_firestart_pulsarfield1 setparent particlecannon_endpos_pulsarfield1

ent_create ambient_generic targetname particlecannon_sound_firestop_pulsarfield1 message weapons/egon_off1.wav pitch 100 cspinup 0 pitchstart 100 radius 12000 SourceEntityName particlecannon_impact_effect_pulsarfield1 spawnflags 48 health 10
ent_fire particlecannon_sound_firestop_pulsarfield1 setparent particlecannon_endpos_pulsarfield1

echo "ParticleCannon Complete!"
echo "Script Made by PulsarField, https://github.com/steadyfield/HL2_Entity_Script"


